#!/usr/bin/make -f

%:
	dh $@

override_dh_autoreconf:

override_dh_auto_test:

override_dh_update_autotools_config:

override_dh_auto_configure:
	sed 's/@DEB_HOST_MULTIARCH@/$(DEB_HOST_MULTIARCH)/g' debian/openthread-dev.dirs.in > debian/openthread-dev.dirs
	dh_auto_configure -- -GNinja \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_EXPORT_COMPILE_COMMANDS=ON \
		-DOT_COMPILE_WARNING_AS_ERROR=ON \
		-DOT_PLATFORM=posix \
		-DOT_SLAAC=ON \
		-DOT_BORDER_AGENT=ON \
		-DOT_BORDER_ROUTER=ON \
		-DOT_COAP=ON \
		-DOT_COAP_BLOCK=ON \
		-DOT_COAP_OBSERVE=ON \
		-DOT_COAPS=ON \
		-DOT_COMMISSIONER=ON \
		-DOT_CHANNEL_MANAGER=ON \
		-DOT_CHANNEL_MONITOR=ON \
		-DOT_CHILD_SUPERVISION=ON \
		-DOT_DATASET_UPDATER=ON \
		-DOT_DHCP6_CLIENT=ON \
		-DOT_DHCP6_SERVER=ON \
		-DOT_DIAGNOSTIC=ON \
		-DOT_DNS_CLIENT=ON \
		-DOT_ECDSA=ON \
		-DOT_IP6_FRAGM=ON \
		-DOT_JAM_DETECTION=ON \
		-DOT_JOINER=ON \
		-DOT_LEGACY=ON \
		-DOT_MAC_FILTER=ON \
		-DOT_MTD_NETDIAG=ON \
		-DOT_NEIGHBOR_DISCOVERY_AGENT=ON \
		-DOT_PING_SENDER=ON \
		-DOT_REFERENCE_DEVICE=ON \
		-DOT_SERVICE=ON \
		-DOT_SNTP_CLIENT=ON \
		-DOT_SRP_CLIENT=ON \
		-DOT_COVERAGE=ON \
		-DOT_LOG_LEVEL_DYNAMIC=ON \
		-DOT_COMPILE_WARNING_AS_ERROR=ON \
		-DOT_RCP_RESTORATION_MAX_COUNT=2 \
		-DOT_LOG_OUTPUT=PLATFORM_DEFINED \
		-DOT_POSIX_MAX_POWER_TABLE=ON \
		-DOT_DAEMON=ON \
		-DOT_TREL=ON \
		-DOT_COVERAGE=OFF -B . -S

override_dh_auto_install:
	dh_auto_install
	mkdir -p debian/tmp/usr/lib/$(DEB_HOST_MULTIARCH)/
	cp -r -d include/ debian/tmp/usr/
	cp obj-$(DEB_HOST_MULTIARCH)/src/cli/libopenthread-cli-mtd.a debian/tmp/usr/lib/$(DEB_HOST_MULTIARCH)/
	cp obj-$(DEB_HOST_MULTIARCH)/src/cli/libopenthread-cli-ftd.a debian/tmp/usr/lib/$(DEB_HOST_MULTIARCH)/
	cp obj-$(DEB_HOST_MULTIARCH)/src/ncp/libopenthread-ncp-mtd.a debian/tmp/usr/lib/$(DEB_HOST_MULTIARCH)/
	cp obj-$(DEB_HOST_MULTIARCH)/src/ncp/libopenthread-ncp-ftd.a debian/tmp/usr/lib/$(DEB_HOST_MULTIARCH)/
	cp obj-$(DEB_HOST_MULTIARCH)/src/ncp/libopenthread-rcp.a debian/tmp/usr/lib/$(DEB_HOST_MULTIARCH)/
	cp obj-$(DEB_HOST_MULTIARCH)/src/lib/hdlc/libopenthread-hdlc.a debian/tmp/usr/lib/$(DEB_HOST_MULTIARCH)/
	cp obj-$(DEB_HOST_MULTIARCH)/src/lib/spinel/libopenthread-spinel-rcp.a debian/tmp/usr/lib/$(DEB_HOST_MULTIARCH)/
	cp obj-$(DEB_HOST_MULTIARCH)/src/lib/spinel/libopenthread-spinel-ncp.a debian/tmp/usr/lib/$(DEB_HOST_MULTIARCH)/
	cp obj-$(DEB_HOST_MULTIARCH)/src/lib/url/libopenthread-url.a debian/tmp/usr/lib/$(DEB_HOST_MULTIARCH)/
	cp obj-$(DEB_HOST_MULTIARCH)/src/lib/platform/libopenthread-platform.a debian/tmp/usr/lib/$(DEB_HOST_MULTIARCH)/
	cp obj-$(DEB_HOST_MULTIARCH)/src/core/libopenthread-ftd.a debian/tmp/usr/lib/$(DEB_HOST_MULTIARCH)/
	cp obj-$(DEB_HOST_MULTIARCH)/src/core/libopenthread-radio.a debian/tmp/usr/lib/$(DEB_HOST_MULTIARCH)/
	cp obj-$(DEB_HOST_MULTIARCH)/src/core/libopenthread-mtd.a debian/tmp/usr/lib/$(DEB_HOST_MULTIARCH)/

